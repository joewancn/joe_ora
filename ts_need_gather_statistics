SELECT DISTINCT OBJECT_NAME(SI.object_id) AS Table_Name ,  
         SI.name AS Statistics_Name ,  
        STATS_DATE(SI.object_id, SI.index_id) AS Last_Stat_Update_Date ,  
        SSI.rowmodctr AS RowModCTR ,  
        SP.rows AS Total_Rows_In_Table ,  
        'UPDATE STATISTICS [' + SCHEMA_NAME(SO.schema_id) + '].['  
        + OBJECT_NAME(SI.object_id) + ']' + SPACE(2) + SI.name AS Update_Stats_Script  
FROM    sys.indexes AS SI( NOLOCK )  
        INNER JOIN sys.objects AS SO( NOLOCK ) ON SI.object_id = SO.object_id  
        INNER JOIN sys.sysindexes SSI( NOLOCK ) ON SI.object_id = SSI.id  
                                                    AND SI.index_id = SSI.indid  
        INNER JOIN sys.partitions AS SP ON SI.object_id = SP.object_id  
WHERE   SSI.rowmodctr > 0  
        AND STATS_DATE(SI.object_id, SI.index_id) IS NOT NULL  
        AND SO.type = 'U'  
ORDER BY RowModCTR DESC;
